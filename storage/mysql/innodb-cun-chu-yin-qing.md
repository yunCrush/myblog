---
description: 这部分记录InnoDB与MyISAM的不同之处，以及Innodb的特点。
---

# MySQL存储引擎

## 1.适用场景

　　**InnoDB: 不保存count，count表示整个表的数据行数。**

**1.CRUD都频繁的场景。**

**2.可靠性要求高，支持事务。**

　　**MyISAM：1.用一个变量保存整个行数，频繁执行全表count。**

**2.对数据增删改不高（涉及到锁表操作），查询高。**

**3.没有事务。**

## 2.锁

　　**MyISAM**默认表级锁，不支持行级锁 **不支持事务** **select 读锁** insert delete update **写锁（排他锁）**

　　**InnoDB**默认行级锁，也支持表级锁 **默认自动提交事务** 二段锁：加锁与解锁两个步骤 不走索引用表级锁。在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻 释放，而是要等到事务结束时才释放。这个就是**两阶段锁协议**。**强制要求主键，根据主键建立聚簇索引**

## 3.数据

　1.InnoDB索引和数据都是放在一块，.ibd文件，原生的数据文件就是按照索引文件的组织结构，使用默认的主键生成聚簇索引，非主键生成的非主键索引即非聚簇索引，根据非主键索引查找，找到叶子节点的data,拿到主键ID，再走聚簇索引找到

```
索引    数据
id=1    (1,22,"张三")
id=2    (2.23,"李四")
...
```

2.MyISAM索引和数据分开，索引在.MyI数据在.MYD

```
索引文件：
id=15, data: 0x1123(数据行的物理地址)
```

```
数据文件：
物理地址        id        name        age
0x1123         15        张三         22
.....
```

将所有的索引放到索引文件中，构成一个B+树，通过B+树进行查找.

**总结**: MyISAM先通过主键索引查找到数据文件的的内存地址，再在数据文件中，找到数据的内存地址对应的数据。而Innodb则直接通过内置的主键生成的索引树，直接找到数据
