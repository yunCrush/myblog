# 安全防护

## 1.跨站脚本攻击（XSS）

XSS ：Cross Site Scripting。恶意攻击者往Web页面里插入恶意Script代码，当用户浏览该页之时，嵌入其中Web里面的Script代码会被执行，从而达到恶意攻击用户的目的。可以窃取cookie和用户数据，进行恶意的跳转如下：

```
<!--恶意脚本植入-->
<script>alert('hey!you are attacked');</script>
```

```
<!--劫持流量实现恶意跳转-->
<script>window.location.href='http://www.baidu.com'</script>
```

```
<img src="a.jpg" onerror="alert('Attack')"/>
```

非正常用户在输入时，并没有输入相关的数据，而是输入了恶意代码，就可以做到流量劫持，实现跳转到恶意的网站，XSS攻击能够实现的主要原因：对用户的输入进行了原样的输出。可以进行长度的限制，限制JS代码直接通过documen.cookie来获取cookie

## 2.跨站点请求伪造(CSRF)

一种可以被攻击者用来通过用户浏览器冒充用户身份向服务器发送伪造请求并被目标服务器成功执行的漏洞被称之为CSRF漏洞,恶意程序冒充受信任用户（浏览器）身份 伪造请求：借助于受信任用户浏览器发起的访问，用户保持登陆状态，hacker通过伪造请求在用户访问了钓鱼网站（比如发送了一个邮件，里面是一条恶意链接）的情况下，返回攻击代码，伪造请求发送给正常网站进行攻击。

![image-20230906143544204](https://cdn.jsdelivr.net/gh/yunCrush/yc-image/image/CSRF.png)

相比XSS攻击：xss是普通植入的是直接进行攻击的，而CSRF是伪造用户请求，前提是cookie没有过期，并且需要对网站有一定的了解，危害可进行修改密码

防护：在Http请求头中验证请求是从哪里发送的，如果是正常的请求，一定是从本域名下发出的，可以在修改密码的时候设置输入原密码，或者图形校验码，或者是邮箱验证码

## 3. URL跳转漏洞

登录功能一直是URL跳转漏洞的重灾区，用户访问网站某个业务，当涉及到账号角色权限的时候一定需要跳转到登陆界面，为了确保用户体验认证结束之后需要自动返回用户之前浏览的页面。这一去一回之间就产生了URL跳转漏洞的隐患。

需要对returnUrl/target后面的域名进行校验,或者对要跳转的链接不是己方的链接则进行风险提示，也可以采用returnUrl=1,1是xxx.com的映射这样。

```
http://www.abc.com/?returnUrl=http://www.abc.com.evil.com
```

## 4. 访问控制

### 4.1 水平攻击

简单而言就是用户A可以对用户B的数据进行修改，在进行数据修改时，可以判断修改的这条数据是否是当前这个用户的

### 4.2 垂直攻击

普通用户A拥有了超级用户的权限，这是不被允许的。基于角色的访问控制（Role-Based Access Control）来解决这种问题，对每个用户分配一个角色，可以使用Spring Security来解决。
