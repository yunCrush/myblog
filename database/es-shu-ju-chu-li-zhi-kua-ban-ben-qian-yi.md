---
description: ESä¸åŒç‰ˆæœ¬ä¹‹é—´å¤‡ä»½çš„æ•°æ®æ˜¯ä¸èƒ½è¿›è¡Œä½¿ç”¨å¿«ç…§è¿˜åŸçš„ã€‚
---

# ESæ•°æ®å¤„ç†ä¹‹è·¨ç‰ˆæœ¬è¿ç§»

ã€€æœ¬æ–‡ä¸­ç”±7.4.0è¿ç§»åˆ°7.4.2ã€‚ä½¿ç”¨åˆ°çš„æ˜¯ ğŸ‘‰ [elasticdump](https://github.com/elasticsearch-dump/elasticsearch-dump)æ’ä»¶ã€‚é€‚ç”¨åœºæ™¯ï¼šé€‚åˆæ•°æ®é‡ä¸å¤§ï¼Œè¿ç§»ç´¢å¼•ä¸ªæ•°ä¸å¤šçš„åœºæ™¯ï¼Œè¿™é‡Œæµ‹è¯•çš„æ•°æ®æ˜¯åœ¨æ¯ä¸ªç´¢å¼•å¤§çº¦15Wçš„æ•°æ®é‡ã€‚

## 1 . å®‰è£…elasticsearch-dump

```text
npm install elasticdump -g
```

## 2 . å‚æ•°è¯´æ˜

```text
--input: æºåœ°å€ï¼Œå¯ä¸ºESé›†ç¾¤URLã€æ–‡ä»¶æˆ–stdin,å¯æŒ‡å®šç´¢å¼•ï¼Œæ ¼å¼ä¸ºï¼š{protocol}://{host}:{port}/{index}
-index: æºESé›†ç¾¤ä¸­çš„ç´¢å¼•
--output: ç›®æ ‡åœ°å€ï¼Œå¯ä¸ºESé›†ç¾¤åœ°å€URLã€æ–‡ä»¶æˆ–stdoutï¼Œå¯æŒ‡å®šç´¢å¼•ï¼Œæ ¼å¼ä¸ºï¼š{protocol}://{host}:{port}/{index}
--output-index: ç›®æ ‡ESé›†ç¾¤çš„ç´¢å¼•
--type: è¿ç§»ç±»å‹ï¼Œé»˜è®¤ä¸ºdata,è¡¨æ˜åªè¿ç§»æ•°æ®ï¼Œå¯é€‰settings, analyzer, data, mapping, alias
--limitï¼šæ¯æ¬¡å‘ç›®æ ‡ESé›†ç¾¤å†™å…¥æ•°æ®çš„æ¡æ•°ï¼Œä¸å¯è®¾ç½®çš„è¿‡å¤§ï¼Œä»¥å…bulké˜Ÿåˆ—å†™
```

## 3.è¿ç§»å•ä¸ªç´¢å¼•

ã€€ã€€ä»¥ä¸‹æ“ä½œé€šè¿‡elasticdumpå‘½ä»¤å°†é›†ç¾¤172.16.0.39ä¸­çš„companydatabaseç´¢å¼•è¿ç§»è‡³é›†ç¾¤172.16.0.20ã€‚æ³¨æ„ç¬¬ä¸€æ¡å‘½ä»¤å…ˆå°†ç´¢å¼•çš„settingså…ˆè¿ç§»ï¼Œå¦‚æœç›´æ¥è¿ç§»mappingæˆ–è€…dataå°†å¤±å»åŸæœ‰é›†ç¾¤ä¸­ç´¢å¼•çš„é…ç½®ä¿¡æ¯å¦‚åˆ†ç‰‡æ•°é‡å’Œå‰¯æœ¬æ•°é‡ç­‰ã€‚

```text
elasticdump --input=http://172.16.0.39:9200/companydatabase --output=http://172.16.0.20:9200/companydatabase --type=settings
elasticdump --input=http://172.16.0.39:9200/companydatabase --output=http://172.16.0.20:9200/companydatabase --type=mapping
elasticdump --input=http://172.16.0.39:9200/companydatabase --output=http://172.16.0.20:9200/companydatabase --type=data
```

ã€€ã€€å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ç›®æ ‡é›†ç¾¤ä¸­å°†ç´¢å¼•åˆ›å»ºå®Œæ¯•åå†åŒæ­¥mappingä¸dataã€‚

## 4.è¿ç§»æ‰€æœ‰ç´¢å¼•

ã€€ã€€ä»¥ä¸‹æ“ä½œé€šè¿‡elasticdumpå‘½ä»¤å°†å°†é›†ç¾¤172.16.0.39ä¸­çš„æ‰€æœ‰ç´¢å¼•è¿ç§»è‡³é›†ç¾¤172.16.0.20ã€‚ æ³¨æ„æ­¤æ“ä½œå¹¶ä¸èƒ½è¿ç§»ç´¢å¼•çš„é…ç½®å¦‚åˆ†ç‰‡æ•°é‡å’Œå‰¯æœ¬æ•°é‡ï¼Œå¿…é¡»å¯¹æ¯ä¸ªç´¢å¼•å•ç‹¬è¿›è¡Œé…ç½®çš„è¿ç§»ï¼Œæˆ–è€…ç›´æ¥åœ¨ç›®æ ‡é›†ç¾¤ä¸­å°†ç´¢å¼•åˆ›å»ºå®Œæ¯•åå†è¿ç§»æ•°æ®ã€‚

```text
elasticdump --input=http://172.16.0.39:9200 --output=http://172.16.0.20:9200
```



