# ZooKeeper核心知识

### 应用场景

1. 数据发布订阅(配置中心)
2. 命名服务(注册中心)
3. Master选举
4. 集群管理(管理集群节点的加入与离开)
5. 分布式队列 6. 分布式锁(节点名不可重复+Watch):多线程并发创建瞬时节点，得到一个有序序列，最小的序号获得锁，完成任务逻辑后，将序号删除，即锁释放，Watch机制会监听前一个节点是否删除,删除后，若自己是最小的节点则获取到锁。 **配置中心** znode存储数据,watch监听数据变化,一个配置项一个znode,或者文件内容放到znode. 客户端订阅相关配置项的路径,`client.subscribeDataChanges(...)` **注册中心** 创建临时节点,客户端获取相关命名服务即可进行调用. **Master选举** 创建一个持久节点,在持久节点下每一个实例节点创建一个临时有序节点,第一个最小的额节点当选Master节点,Watch机制会监听前一个节点是否删除,当第一个宕机后,后续的第二个节点当选Master节点. ![](https://cdn.jsdelivr.net/gh/yunCrush/yc-image/image/zk-sample-master%E9%80%89%E4%B8%BE.png) **分布式队列** 创建一个持久节点,入队: 生产者向持久节点写入顺序节点, 出队: 选取最小的出队删除.如果是有界队列,则需要用到分布式锁来判断当前Queue中数据的多少.
